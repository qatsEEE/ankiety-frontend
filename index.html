OK, widzę dokładnie, co się stało. To bardzo częsta pomyłka, gdy pracuje się z wieloma plikami na raz. Nie przejmuj się, zaraz to naprawimy.

Problem polega na tym, że przez pomyłkę wkleiłeś kod HTML do pliku C#.

## Diagnoza
Kompilator C# (program, który buduje Twoją aplikację backendową) zgłasza setki błędów, zaczynając od:
Error CS1525 : W wyrażeniu występuje nieprawidłowe określenie „<”

Ten błąd pojawia się na samym początku pliku, ponieważ plik index.html, który Ci podałem, zaczyna się od znacznika <!DOCTYPE html>, czyli właśnie od znaku <. Kompilator C# nie rozumie języka HTML i dlatego zgłasza błąd składni, a potem lawinę kolejnych błędów.

Musimy po prostu umieścić właściwy kod we właściwym pliku.

## Plan Naprawczy (Krok po kroku)
Będziemy musieli uporządkować dwa pliki: C# (PollFunctions.cs) i HTML (index.html).

#### Krok 1: Przywróć poprawny kod w PollFunctions.cs
W JetBrains Rider otwórz plik PollFunctions.cs.
Skasuj całą jego zawartość.
Wklej w to miejsce poniższy, poprawny kod C#:
C#

// POPRAWNY KOD DLA PLIKU PollFunctions.cs
using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Text.Json;
using System.Threading.Tasks;
using Microsoft.Azure.Functions.Worker;
using Microsoft.Azure.Functions.Worker.Http;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Logging;

namespace AnkietySystem
{
public class PollFunctions
{
private readonly ApplicationDbContext _context;
private readonly ILogger<PollFunctions> _logger;

    public PollFunctions(ApplicationDbContext context, ILogger<PollFunctions> logger)
        {
        _context = context;
        _logger = logger;
        }

        [Function("negotiate")]
        public HttpResponseData Negotiate(
        [HttpTrigger(AuthorizationLevel.Anonymous, "get", "post", Route = "negotiate")] HttpRequestData req,
        [SignalRConnectionInfoInput(HubName = "polls")] string connectionInfo)
        {
        var response = req.CreateResponse(HttpStatusCode.OK);
        response.Headers.Add("Content-Type", "application/json");
        response.WriteString(connectionInfo);
        return response;
        }

        [Function("vote")]
        [SignalROutput(HubName = "polls")]
        public async Task<SignalRMessageAction> Vote(
            [HttpTrigger(AuthorizationLevel.Anonymous, "post", Route = "polls/vote")] HttpRequestData req)
            {
            _logger.LogInformation("Processing a vote request.");
            string requestBody = await new StreamReader(req.Body).ReadToEndAsync();
            var voteRequest = JsonSerializer.Deserialize<VoteRequest>(requestBody);

                if (voteRequest == null) return null;

                var pollOption = await _context.PollOptions.FindAsync(voteRequest.OptionId);
                if (pollOption == null) return null;

                pollOption.Votes++;
                await _context.SaveChangesAsync();

                return new SignalRMessageAction("newVote")
                {
                Arguments = new object[] { pollOption.PollId, pollOption.Id, pollOption.Votes }
                };
                }

                [Function("GetPoll")]
                public async Task<HttpResponseData> GetPoll(
                    [HttpTrigger(AuthorizationLevel.Anonymous, "get", Route = "polls/{id}")] HttpRequestData req, int id)
                    {
                    _logger.LogInformation($"Getting poll with ID: {id}");
                    var poll = await _context.Polls
                    .Include(p => p.Options)
                    .FirstOrDefaultAsync(p => p.Id == id);

                    if (poll == null) return req.CreateResponse(HttpStatusCode.NotFound);

                    var response = req.CreateResponse(HttpStatusCode.OK);
                    await response.WriteAsJsonAsync(poll);
                    return response;
                    }

                    [Function("CreatePoll")]
                    public async Task<HttpResponseData> CreatePoll(
                        [HttpTrigger(AuthorizationLevel.Anonymous, "post", Route = "polls")] HttpRequestData req)
                        {
                        _logger.LogInformation("Creating a new poll.");
                        string requestBody = await new StreamReader(req.Body).ReadToEndAsync();
                        var newPoll = JsonSerializer.Deserialize<Poll>(requestBody);

                            if (newPoll == null || string.IsNullOrEmpty(newPoll.Question) || newPoll.Options.Count < 2)
                            {
                            return req.CreateResponse(HttpStatusCode.BadRequest);
                            }

                            _context.Polls.Add(newPoll);
                            await _context.SaveChangesAsync();

                            var response = req.CreateResponse(HttpStatusCode.Created);
                            await response.WriteAsJsonAsync(newPoll);
                            return response;
                            }
                            }

                            public class VoteRequest
                            {
                            public int OptionId { get; set; }
                            }
                            }
                            #### Krok 2: Wklej poprawny kod do index.html
                            Teraz znajdź swój plik index.html.
                            Skasuj całą jego zawartość.
                            Wklej w to miejsce poniższy, poprawny kod HTML z ulepszonym wyglądem:
                            HTML

                            <!DOCTYPE html>
                            <html lang="pl">
                            <head>
                                <meta charset="UTF-8">
                                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                <title>System Ankiet w Czasie Rzeczywistym</title>
                                <style>
                                    body {
                                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
                                        background-color: #f4f7f6;
                                        color: #333;
                                        margin: 0;
                                        padding: 2rem;
                                        display: flex;
                                        justify-content: center;
                                        align-items: flex-start;
                                        min-height: 100vh;
                                    }
                                    #app-container {
                                        background-color: #ffffff;
                                        border-radius: 12px;
                                        box-shadow: 0 8px 30px rgba(0,0,0,0.1);
                                        padding: 2rem 3rem;
                                        width: 100%;
                                        max-width: 700px;
                                    }
                                    h1 {
                                        color: #2c3e50;
                                        text-align: center;
                                        margin-bottom: 0.5rem;
                                    }
                                    h2 {
                                        color: #34495e;
                                        margin-top: 0;
                                        margin-bottom: 2rem;
                                        text-align: center;
                                        font-weight: 400;
                                    }
                                    .option {
                                        margin-bottom: 1.5rem;
                                    }
                                    .bar-container {
                                        background-color: #eaf0f6;
                                        border-radius: 5px;
                                        height: 28px;
                                        overflow: hidden;
                                        margin-top: 0.5rem;
                                    }
                                    .bar {
                                        background-color: #3498db;
                                        height: 100%;
                                        display: flex;
                                        align-items: center;
                                        justify-content: flex-end;
                                        color: white;
                                        padding-right: 10px;
                                        font-size: 0.9em;
                                        font-weight: bold;
                                        box-sizing: border-box;
                                        white-space: nowrap;
                                        transition: width 0.5s cubic-bezier(0.25, 1, 0.5, 1);
                                    }
                                    button {
                                        background-color: #3498db;
                                        color: white;
                                        border: none;
                                        border-radius: 5px;
                                        padding: 10px 18px;
                                        font-size: 1em;
                                        cursor: pointer;
                                        margin-top: 0.75rem;
                                        transition: background-color 0.2s;
                                    }
                                    button:hover {
                                        background-color: #2980b9;
                                    }
                                </style>
                            </head>
                            <body>
                            <div id="app-container">
                                <h1>System Ankiet</h1>
                                <div id="poll-container">Ładowanie ankiety...</div>
                            </div>

                            <script src="https://cdn.jsdelivr.net/npm/@microsoft/signalr@8.0.0/dist/browser/signalr.min.js"></script>
                            <script>
                                const apiUrl = "https://ankietyapi-da.azurewebsites.net/api";
                                const pollIdToLoad = 1;

                                const container = document.getElementById('poll-container');
                                let currentPollData = null;

                                async function fetchAndRenderPoll() {
                                    try {
                                        const response = await fetch(`${apiUrl}/polls/${pollIdToLoad}`);
                                        if (!response.ok) {
                                            container.innerHTML = "<h2>Nie znaleziono ankiety o podanym ID. Użyj Postmana, aby ją stworzyć.</h2>";
                                            return;
                                        }
                                        currentPollData = await response.json();
                                        renderOptions();
                                    } catch (error) {
                                        container.innerHTML = "<h2>Błąd podczas ładowania ankiety. Sprawdź konsolę (F12).</h2>";
                                        console.error(error);
                                    }
                                }

                                function renderOptions() {
                                    if (!currentPollData) return;
                                    const totalVotes = currentPollData.Options.reduce((sum, opt) => sum + opt.Votes, 0);

                                    let html = `<h2>${currentPollData.Question}</h2>`;
                                    currentPollData.Options.forEach(opt => {
                                        const percentage = totalVotes > 0 ? ((opt.Votes / totalVotes) * 100).toFixed(1) : 0;
                                        html += `
                    <div class="option" id="option-${opt.Id}">
                        <span>${opt.Text}</span>
                        <div class="bar-container">
                             <div class="bar" style="width: ${percentage}%;">${opt.Votes} głosów</div>
                        </div>
                        <button onclick="vote(${opt.Id})">Głosuj</button>
                    </div>
                `;
                                    });
                                    container.innerHTML = html;
                                }

                                async function vote(optionId) {
                                    await fetch(`${apiUrl}/polls/vote`, {
                                        method: 'POST',
                                        headers: { 'Content-Type': 'application/json' },
                                        body: JSON.stringify({ OptionId: optionId })
                                    });
                                }

                                const connection = new signalR.HubConnectionBuilder()
                                    .withUrl(`${apiUrl}`)
                                    .withAutomaticReconnect()
                                    .build();

                                connection.on("newVote", (updatedPollId, updatedOptionId, newVoteCount) => {
                                    if (currentPollData && updatedPollId === currentPollData.Id) {
                                        const option = currentPollData.Options.find(o => o.Id === updatedOptionId);
                                        if (option) {
                                            option.Votes = newVoteCount;
                                            renderOptions();
                                        }
                                    }
                                });

                                async function startSignalR() {
                                    try {
                                        await connection.start();
                                        console.log("Połączono z SignalR.");
                                    } catch (err) {
                                        console.error("Błąd połączenia z SignalR:", err);
                                    }
                                };

                                fetchAndRenderPoll();
                                startSignalR();
                            </script>
                            </body>
                            </html>
